2025-12-04 23:21:48,912 - app.logger - INFO - Logging system initialized with rotation
2025-12-04 23:21:48,914 - app.logger - INFO - Removed old log file: logs/antivirus_20251126.log
2025-12-04 23:21:48,946 - app.database - INFO - Initializing database at: /opt/Aegis/data/antivirus.db
2025-12-04 23:21:48,949 - app.database - INFO - Database initialized successfully with all tables
2025-12-04 23:21:49,082 - app.logger - INFO - [ENV] env.env loaded: yes (/opt/aegis/antivirus-core/app/env.env)
2025-12-04 23:21:49,082 - app.logger - INFO - [ENV] VIRUSTOTAL_API_KEY: 8958...96ce
2025-12-04 23:21:49,083 - app.logger - INFO - [External APIs] Enabled map: {'virustotal': True, 'google_safe_browsing': False, 'abuseipdb': True}
2025-12-04 23:21:49,152 - app.logger - INFO - üöÄ AEGIS Server starting up...
2025-12-04 23:21:49,153 - app.logger - INFO - ‚úÖ Database tables verified
2025-12-04 23:21:49,154 - app.logger - INFO - Database connection established successfully
2025-12-04 23:21:49,158 - app.database - INFO - Rate limits reset successfully
2025-12-04 23:21:49,158 - app.logger - INFO - Rate limits reset
2025-12-04 23:21:49,159 - app.logger - INFO - Background job manager started
2025-12-04 23:21:49,159 - app.logger - INFO - Background job manager started
2025-12-04 23:21:49,159 - app.logger - INFO - WebSocket cleanup task started
2025-12-04 23:21:49,159 - app.logger - INFO - ‚úÖ AEGIS Server startup complete
2025-12-04 23:21:49,774 - app.logger - INFO - [WS] WebSocket connection attempt from 91.238.88.83
2025-12-04 23:21:49,775 - app.logger - INFO - [WS] WebSocket connection accepted from 91.238.88.83
2025-12-04 23:21:49,779 - app.logger - INFO - [WS] Client connected: id=90b7b6fe-6579-47d4-bde0-46cdbd3d4908, ip=91.238.88.83
2025-12-04 23:21:52,941 - app.logger - INFO - [WS] Starting URL analysis for: https://cursor.com/agents (context: hover)
2025-12-04 23:21:52,941 - app.logger - INFO - üîç Analyzing URL: https://cursor.com/agents (ignore_db=False)
2025-12-04 23:21:52,949 - app.logger - INFO - üîç Checking external APIs for: https://cursor.com/agents
2025-12-04 23:21:53,303 - app.logger - INFO - Found URL in VirusTotal database: https://cursor.com/agents
2025-12-04 23:21:53,304 - app.logger - INFO - üîç Combining external results for https://cursor.com/agents: {'virustotal': {'data': {'id': '50d2983119d15c52f0204a0d1f6b42050f85b6c1feb7e54c80ec7343fc740a93', 'type': 'url', 'links': {'self': 'https://www.virustotal.com/api/v3/urls/50d2983119d15c52f0204a0d1f6b42050f85b6c1feb7e54c80ec7343fc740a93'}, 'attributes': {'last_final_url': 'https://cursor.com/agents', 'last_http_response_content_length': 94046, 'categories': {'BitDefender': 'business', 'Sophos': 'information technology', 'Forcepoint ThreatSeeker': 'generative ai - text & code', 'Xcitium Verdict Cloud': 'visual search'}, 'last_http_response_content_sha256': '0a70ede8c258501b4637269f674668abbd01c0bab7c58f6e499b057c5783caf4', 'total_votes': {'harmless': 0, 'malicious': 0}, 'outgoing_links': ['https://www.cursor.com/terms-of-service', 'https://www.cursor.com/privacy', 'https://workos.imgix.net/app-branding/environment_01GS6W3C901N50J4ZGFB6V1Z6C/01K7002RKC1S3W3WGAGWBX547Y', 'https://workos.imgix.net/app-branding/environment_01GS6W3C901N50J4ZGFB6V1Z6C/01K7002RKAGJ71T32Q78NC7KSC', 'https://cdn.workos.com', 'https://fonts.googleapis.com', 'https://fonts.gstatic.com', 'https://cdn.workos.com/css/font-cursor-gothic.css', 'https://workos.imgix.net/app-branding/environment_01GS6W3C901N50J4ZGFB6V1Z6C/01K6ZWC3PHD9RH99VX6XZVAJ6T', 'https://workos.imgix.net/app-branding/environment_01GS6W3C901N50J4ZGFB6V1Z6C/01K6ZWC3Q022AX8XY2B9TXGK9D'], 'times_submitted': 8, 'last_submission_date': 1761965118, 'last_analysis_date': 1761965118, 'first_submission_date': 1751414700, 'last_analysis_results': {'Artists Against 419': {'method': 'blacklist', 'engine_name': 'Artists Against 419', 'category': 'harmless', 'result': 'clean'}, 'Acronis': {'method': 'blacklist', 'engine_name': 'Acronis', 'category': 'harmless', 'result': 'clean'}, 'Abusix': {'method': 'blacklist', 'engine_name': 'Abusix', 'category': 'harmless', 'result': 'clean'}, 'ADMINUSLabs': {'method': 'blacklist', 'engine_name': 'ADMINUSLabs', 'category': 'harmless', 'result': 'clean'}, 'Lionic': {'method': 'blacklist', 'engine_name': 'Lionic', 'category': 'harmless', 'result': 'clean'}, 'Criminal IP': {'method': 'blacklist', 'engine_name': 'Criminal IP', 'category': 'harmless', 'result': 'clean'}, 'AILabs (MONITORAPP)': {'method': 'blacklist', 'engine_name': 'AILabs (MONITORAPP)', 'category': 'harmless', 'result': 'clean'}, 'AlienVault': {'method': 'blacklist', 'engine_name': 'AlienVault', 'category': 'harmless', 'result': 'clean'}, 'alphaMountain.ai': {'method': 'blacklist', 'engine_name': 'alphaMountain.ai', 'category': 'undetected', 'result': 'unrated'}, 'AlphaSOC': {'method': 'blacklist', 'engine_name': 'AlphaSOC', 'category': 'undetected', 'result': 'unrated'}, 'Antiy-AVL': {'method': 'blacklist', 'engine_name': 'Antiy-AVL', 'category': 'harmless', 'result': 'clean'}, 'ArcSight Threat Intelligence': {'method': 'blacklist', 'engine_name': 'ArcSight Threat Intelligence', 'category': 'undetected', 'result': 'unrated'}, 'AutoShun': {'method': 'blacklist', 'engine_name': 'AutoShun', 'category': 'undetected', 'result': 'unrated'}, 'Axur': {'method': 'blacklist', 'engine_name': 'Axur', 'category': 'undetected', 'result': 'unrated'}, 'benkow.cc': {'method': 'blacklist', 'engine_name': 'benkow.cc', 'category': 'harmless', 'result': 'clean'}, 'Bfore.Ai PreCrime': {'method': 'blacklist', 'engine_name': 'Bfore.Ai PreCrime', 'category': 'undetected', 'result': 'unrated'}, 'BitDefender': {'method': 'blacklist', 'engine_name': 'BitDefender', 'category': 'harmless', 'result': 'clean'}, 'Bkav': {'method': 'blacklist', 'engine_name': 'Bkav', 'category': 'undetected', 'result': 'unrated'}, 'BlockList': {'method': 'blacklist', 'engine_name': 'BlockList', 'category': 'harmless', 'result': 'clean'}, 'Blueliv': {'method': 'blacklist', 'engine_name': 'Blueliv', 'category': 'harmless', 'result': 'clean'}, 'Certego': {'method': 'blacklist', 'engine_name': 'Certego', 'category': 'harmless', 'result': 'clean'}, 'ChainPatrol': {'method': 'blacklist', 'engine_name': 'ChainPatrol', 'category': 'undetected', 'result': 'unrated'}, 'Chong Lua Dao': {'method': 'blacklist', 'engine_name': 'Chong Lua Dao', 'category': 'harmless', 'result': 'clean'}, 'CINS Army': {'method': 'blacklist', 'engine_name': 'CINS Army', 'category': 'harmless', 'result': 'clean'}, 'Snort IP sample list': {'method': 'blacklist', 'engine_name': 'Snort IP sample list', 'category': 'harmless', 'result': 'clean'}, 'Cluster25': {'method': 'blacklist', 'engine_name': 'Cluster25', 'category': 'undetected', 'result': 'unrated'}, 'CMC Threat Intelligence': {'method': 'blacklist', 'engine_name': 'CMC Threat Intelligence', 'category': 'harmless', 'result': 'clean'}, 'Xcitium Verdict Cloud': {'method': 'blacklist', 'engine_name': 'Xcitium Verdict Cloud', 'category': 'undetected', 'result': 'unrated'}, 'CRDF': {'method': 'blacklist', 'engine_name': 'CRDF', 'category': 'harmless', 'result': 'clean'}, 'CSIS Security Group': {'method': 'blacklist', 'engine_name': 'CSIS Security Group', 'category': 'undetected', 'result': 'unrated'}, 'Cyan': {'method': 'blacklist', 'engine_name': 'Cyan', 'category': 'undetected', 'result': 'unrated'}, 'Cyble': {'method': 'blacklist', 'engine_name': 'Cyble', 'category': 'harmless', 'result': 'clean'}, 'CyRadar': {'method': 'blacklist', 'engine_name': 'CyRadar', 'category': 'harmless', 'result': 'clean'}, 'desenmascara.me': {'method': 'blacklist', 'engine_name': 'desenmascara.me', 'category': 'harmless', 'result': 'clean'}, 'DNS8': {'method': 'blacklist', 'engine_name': 'DNS8', 'category': 'harmless', 'result': 'clean'}, 'Dr.Web': {'method': 'blacklist', 'engine_name': 'Dr.Web', 'category': 'harmless', 'result': 'clean'}, 'Emsisoft': {'method': 'blacklist', 'engine_name': 'Emsisoft', 'category': 'harmless', 'result': 'clean'}, 'Ermes': {'method': 'blacklist', 'engine_name': 'Ermes', 'category': 'undetected', 'result': 'unrated'}, 'ESET': {'method': 'blacklist', 'engine_name': 'ESET', 'category': 'harmless', 'result': 'clean'}, 'ESTsecurity': {'method': 'blacklist', 'engine_name': 'ESTsecurity', 'category': 'harmless', 'result': 'clean'}, 'EmergingThreats': {'method': 'blacklist', 'engine_name': 'EmergingThreats', 'category': 'harmless', 'result': 'clean'}, 'Feodo Tracker': {'method': 'blacklist', 'engine_name': 'Feodo Tracker', 'category': 'harmless', 'result': 'clean'}, 'Fortinet': {'method': 'blacklist', 'engine_name': 'Fortinet', 'category': 'harmless', 'result': 'clean'}, 'G-Data': {'method': 'blacklist', 'engine_name': 'G-Data', 'category': 'harmless', 'result': 'clean'}, 'Google Safebrowsing': {'method': 'blacklist', 'engine_name': 'Google Safebrowsing', 'category': 'harmless', 'result': 'clean'}, 'GCP Abuse Intelligence': {'method': 'blacklist', 'engine_name': 'GCP Abuse Intelligence', 'category': 'undetected', 'result': 'unrated'}, 'GreenSnow': {'method': 'blacklist', 'engine_name': 'GreenSnow', 'category': 'harmless', 'result': 'clean'}, 'Gridinsoft': {'method': 'blacklist', 'engine_name': 'Gridinsoft', 'category': 'undetected', 'result': 'unrated'}, 'Heimdal Security': {'method': 'blacklist', 'engine_name': 'Heimdal Security', 'category': 'harmless', 'result': 'clean'}, 'Hunt.io Intelligence': {'method': 'blacklist', 'engine_name': 'Hunt.io Intelligence', 'category': 'undetected', 'result': 'unrated'}, 'IPsum': {'method': 'blacklist', 'engine_name': 'IPsum', 'category': 'harmless', 'result': 'clean'}, 'Juniper Networks': {'method': 'blacklist', 'engine_name': 'Juniper Networks', 'category': 'harmless', 'result': 'clean'}, 'Kaspersky': {'method': 'blacklist', 'engine_name': 'Kaspersky', 'category': 'harmless', 'result': 'clean'}, 'Lumu': {'method': 'blacklist', 'engine_name': 'Lumu', 'category': 'undetected', 'result': 'unrated'}, 'Malwared': {'method': 'blacklist', 'engine_name': 'Malwared', 'category': 'harmless', 'result': 'clean'}, 'MalwareURL': {'method': 'blacklist', 'engine_name': 'MalwareURL', 'category': 'undetected', 'result': 'unrated'}, 'MalwarePatrol': {'method': 'blacklist', 'engine_name': 'MalwarePatrol', 'category': 'harmless', 'result': 'clean'}, 'malwares.com URL checker': {'method': 'blacklist', 'engine_name': 'malwares.com URL checker', 'category': 'harmless', 'result': 'clean'}, 'Mimecast': {'method': 'blacklist', 'engine_name': 'Mimecast', 'category': 'undetected', 'result': 'unrated'}, 'Netcraft': {'method': 'blacklist', 'engine_name': 'Netcraft', 'category': 'undetected', 'result': 'unrated'}, 'OpenPhish': {'method': 'blacklist', 'engine_name': 'OpenPhish', 'category': 'harmless', 'result': 'clean'}, '0xSI_f33d': {'method': 'blacklist', 'engine_name': '0xSI_f33d', 'category': 'undetected', 'result': 'unrated'}, 'Phishing Database': {'method': 'blacklist', 'engine_name': 'Phishing Database', 'category': 'harmless', 'result': 'clean'}, 'PhishFort': {'method': 'blacklist', 'engine_name': 'PhishFort', 'category': 'undetected', 'result': 'unrated'}, 'PhishLabs': {'method': 'blacklist', 'engine_name': 'PhishLabs', 'category': 'undetected', 'result': 'unrated'}, 'Phishtank': {'method': 'blacklist', 'engine_name': 'Phishtank', 'category': 'harmless', 'result': 'clean'}, 'PREBYTES': {'method': 'blacklist', 'engine_name': 'PREBYTES', 'category': 'harmless', 'result': 'clean'}, 'PrecisionSec': {'method': 'blacklist', 'engine_name': 'PrecisionSec', 'category': 'undetected', 'result': 'unrated'}, 'Quick Heal': {'method': 'blacklist', 'engine_name': 'Quick Heal', 'category': 'harmless', 'result': 'clean'}, 'Quttera': {'method': 'blacklist', 'engine_name': 'Quttera', 'category': 'harmless', 'result': 'clean'}, 'Rising': {'method': 'blacklist', 'engine_name': 'Rising', 'category': 'harmless', 'result': 'clean'}, 'SafeToOpen': {'method': 'blacklist', 'engine_name': 'SafeToOpen', 'category': 'undetected', 'result': 'unrated'}, 'Sangfor': {'method': 'blacklist', 'engine_name': 'Sangfor', 'category': 'harmless', 'result': 'clean'}, 'Sansec eComscan': {'method': 'blacklist', 'engine_name': 'Sansec eComscan', 'category': 'undetected', 'result': 'unrated'}, 'Scantitan': {'method': 'blacklist', 'engine_name': 'Scantitan', 'category': 'harmless', 'result': 'clean'}, 'SCUMWARE.org': {'method': 'blacklist', 'engine_name': 'SCUMWARE.org', 'category': 'harmless', 'result': 'clean'}, 'Seclookup': {'method': 'blacklist', 'engine_name': 'Seclookup', 'category': 'harmless', 'result': 'clean'}, 'SOCRadar': {'method': 'blacklist', 'engine_name': 'SOCRadar', 'category': 'undetected', 'result': 'unrated'}, 'Sophos': {'method': 'blacklist', 'engine_name': 'Sophos', 'category': 'harmless', 'result': 'clean'}, 'Spam404': {'method': 'blacklist', 'engine_name': 'Spam404', 'category': 'harmless', 'result': 'clean'}, 'StopForumSpam': {'method': 'blacklist', 'engine_name': 'StopForumSpam', 'category': 'harmless', 'result': 'clean'}, 'Sucuri SiteCheck': {'method': 'blacklist', 'engine_name': 'Sucuri SiteCheck', 'category': 'harmless', 'result': 'clean'}, 'securolytics': {'method': 'blacklist', 'engine_name': 'securolytics', 'category': 'harmless', 'result': 'clean'}, 'Threatsourcing': {'method': 'blacklist', 'engine_name': 'Threatsourcing', 'category': 'harmless', 'result': 'clean'}, 'ThreatHive': {'method': 'blacklist', 'engine_name': 'ThreatHive', 'category': 'harmless', 'result': 'clean'}, 'Trustwave': {'method': 'blacklist', 'engine_name': 'Trustwave', 'category': 'harmless', 'result': 'clean'}, 'Underworld': {'method': 'blacklist', 'engine_name': 'Underworld', 'category': 'undetected', 'result': 'unrated'}, 'URLhaus': {'method': 'blacklist', 'engine_name': 'URLhaus', 'category': 'harmless', 'result': 'clean'}, 'URLQuery': {'method': 'blacklist', 'engine_name': 'URLQuery', 'category': 'harmless', 'result': 'clean'}, 'Viettel Threat Intelligence': {'method': 'blacklist', 'engine_name': 'Viettel Threat Intelligence', 'category': 'harmless', 'result': 'clean'}, 'VIPRE': {'method': 'blacklist', 'engine_name': 'VIPRE', 'category': 'undetected', 'result': 'unrated'}, 'ViriBack': {'method': 'blacklist', 'engine_name': 'ViriBack', 'category': 'harmless', 'result': 'clean'}, 'VX Vault': {'method': 'blacklist', 'engine_name': 'VX Vault', 'category': 'harmless', 'result': 'clean'}, 'Webroot': {'method': 'blacklist', 'engine_name': 'Webroot', 'category': 'harmless', 'result': 'clean'}, 'Forcepoint ThreatSeeker': {'method': 'blacklist', 'engine_name': 'Forcepoint ThreatSeeker', 'category': 'harmless', 'result': 'clean'}, 'Yandex Safebrowsing': {'method': 'blacklist', 'engine_name': 'Yandex Safebrowsing', 'category': 'harmless', 'result': 'clean'}, 'ZeroCERT': {'method': 'blacklist', 'engine_name': 'ZeroCERT', 'category': 'harmless', 'result': 'clean'}, 'ZeroFox': {'method': 'blacklist', 'engine_name': 'ZeroFox', 'category': 'undetected', 'result': 'unrated'}}, 'last_http_response_code': 200, 'reputation': 0, 'threat_names': [], 'tld': 'com', 'redirection_chain': ['https://cursor.com/agents'], 'tags': ['third-party-cookies', 'iframes'], 'last_modification_date': 1761979204, 'html_meta': {'viewport': ['width=device-width, initial-scale=1']}, 'last_analysis_stats': {'malicious': 0, 'suspicious': 0, 'undetected': 30, 'harmless': 68, 'timeout': 0}, 'last_http_response_headers': {'referrer-policy': 'strict-origin-when-cross-origin', 'sec-fetch-dest': 'document', 'x-forwarded-host': 'cursor.com', 'x-real-ip': '34.71.214.216', 'x-vercel-ip-country': 'US', 'x-vercel-ip-country-region': 'IA', 'x-vercel-ip-longitude': '-95.8517', 'x-vercel-ja3-digest': '946be6b0fa744d911896e56115efb351', 'accept-language': 'en-US,en;q=0.9', 'content-encoding': 'br', 'content-security-policy': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://*.vercel.live https://vercel.live https://*.vercel-scripts.com https://*.posthog.com https://*.unifyintent.com https://*.cloudfront.net https://pro.ip-api.com https://*.liadm.com https://*.usbrowserspeed.com https://alocdn.com https://featureassets.org https://prodregistryv2.org; style-src 'self' 'unsafe-inline' https://vercel.com; img-src 'self' data: https://vercel.com https://avatars.githubusercontent.com https://workoscdn.com https://*.basehub.earth https://*.basehub.com https://*.workoscdn.com https://*.vercel.live https://vercel.com https://*.vercel-scripts.com https://*.pusher.com wss://*.pusher.com https://*.posthog.com https://*.cursor.sh https://*.cursor.com https://*.unifyintent.com; font-src 'self' data: https://vercel.live; connect-src 'self' https://*.basehub.earth https://*.basehub.com https://*.workoscdn.com https://*.vercel.live https://vercel.com https://*.vercel-scripts.com https://*.pusher.com wss://*.pusher.com ht", 'content-type': 'text/html; charset=utf-8', 'date': 'Sat, 01 Nov 2025 02:45:24 GMT', 'priority': 'u=0, i', 'x-vercel-ip-as-number': '396982', 'x-xss-protection': '1; mode=block', 'accept-ch': 'Sec-CH-UA-Arch, Sec-CH-UA-Platform, Sec-CH-UA-Platform-Version, Sec-CH-UA-Bitness', 'forwarded': 'for=34.71.214.216;host=cursor.com;proto=https', 'strict-transport-security': 'max-age=31536000; includeSubDomains', 'upgrade-insecure-requests': '1', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36', 'accept-encoding': 'gzip, deflate, br, zstd', 'link': '</_next/static/media/063d985d4cff9946.p.woff2>; rel=preload; as="font"; crossorigin=""; type="font/woff2", </_next/static/media/262030e3578d15d6.p.woff2>; rel=preload; as="font"; crossorigin=""; type="font/woff2", </_next/static/media/66f30814ff6d7cdf.p.woff2>; rel=preload; as="font"; crossorigin=""; type="font/woff2", </_next/static/media/73dbdf3a713d2a94.p.woff2>; rel=preload; as="font"; crossorigin=""; type="font/woff2", </_next/static/media/b58810aa08bd73e2.p.woff2>; rel=preload; as="font"; crossorigin=""; type="font/woff2", </_next/static/media/e11418ac562b8ac1-s.p.woff2>; rel=preload; as="font"; crossorigin=""; type="font/woff2", </_next/static/css/b3338dbcfa866678.css?dpl=dpl_riL5A9MqXaBUqCWpb57vHdP9swnB>; rel=preload; as="style", </_next/static/css/a88f69b4c7b4c2d4.css?dpl=dpl_riL5A9MqXaBUqCWpb57vHdP9swnB>; rel=preload; as="style", </_next/static/css/b3f6cd5df383893d.css?dpl=dpl_riL5A9MqXaBUqCWpb57vHdP9swnB>; rel=preload; as="style", </_next/static/css/8d783b7b2ed5c1af.css?dpl=dpl_riL5A9MqXaBUqCWpb57v', 'vary': 'rsc, next-router-state-tree, next-router-prefetch, next-router-segment-prefetch', 'x-vercel-cache': 'MISS', 'x-vercel-ip-postal-code': '51502', 'x-vercel-ip-timezone': 'America/Chicago', 'x-vercel-ja4-digest': 't13d1516h2_8daaf6152771_d8a2da3f94cd', 'sec-fetch-mode': 'navigate', 'sec-fetch-site': 'none', 'sec-fetch-user': '?1', 'x-generaltranslation-locale': 'en-US', 'x-vercel-ip-continent': 'NA', 'age': '0', 'x-forwarded-proto': 'https', 'x-frame-options': 'SAMEORIGIN', 'x-powered-by': 'Next.js', 'x-user-country': 'US', 'x-vercel-id': 'sfo1:sfo1::iad1::t7rqh-1761965124836-2d51e31e609a', 'x-vercel-ip-latitude': '41.2591', 'server': 'Vercel', 'x-forwarded-for': '34.71.214.216', 'x-matched-path': '/[locale]/agents', 'x-permitted-cross-domain-policies': 'none', 'x-vercel-proxied-for': '34.71.214.216', 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7', 'cache-control': 'private, no-cache, no-store, max-age=0, must-revalidate', 'x-content-type-options': 'nosniff', 'x-vercel-ip-city': 'Council%20Bluffs'}, 'title': 'Sign in', 'url': 'https://cursor.com/agents'}}}}
2025-12-04 23:21:53,305 - app.logger - INFO - [VirusTotal] Raw stats: malicious=0 suspicious=0 undetected=30 harmless=68 total=98 ratio=0/98 (results=0)
2025-12-04 23:21:53,305 - app.logger - INFO - [VirusTotal] Parsed result (conservative): {'safe': True, 'threat_type': None, 'details': '–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ 98 –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏, —É–≥—Ä–æ–∑ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ', 'external_scan': 'virustotal', 'confidence': 90, 'detection_ratio': '0/98', 'raw_data': {'malicious_detections': 0, 'suspicious_detections': 0, 'undetected': 30, 'harmless': 68, 'total_engines': 98, 'undetected_ratio': 0.30612244897959184, 'harmless_ratio': 0.6938775510204082, 'is_young': False}}
2025-12-04 23:21:53,305 - app.logger - INFO - üîç VirusTotal parsed result: {'safe': True, 'threat_type': None, 'details': '–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ 98 –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞–º–∏, —É–≥—Ä–æ–∑ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ', 'external_scan': 'virustotal', 'confidence': 90, 'detection_ratio': '0/98', 'raw_data': {'malicious_detections': 0, 'suspicious_detections': 0, 'undetected': 30, 'harmless': 68, 'total_engines': 98, 'undetected_ratio': 0.30612244897959184, 'harmless_ratio': 0.6938775510204082, 'is_young': False}}
2025-12-04 23:21:53,306 - app.logger - INFO - At least one API returned safe=True (safe_count=1, enabled=2, total_checks=1), treating as safe
2025-12-04 23:21:53,306 - app.logger - INFO - üîç Final external API result for https://cursor.com/agents: safe=True, threat_type=None, details=All external scans clean
2025-12-04 23:21:53,306 - app.logger - INFO - üîç External API result: safe=True, threat_type=None
2025-12-04 23:21:53,306 - app.logger - INFO - ‚úÖ External APIs found https://cursor.com/agents to be safe
2025-12-04 23:21:53,307 - app.logger - INFO - Not all external APIs returned results for https://cursor.com/agents, but at least one returned safe=True, treating as safe
2025-12-04 23:21:53,310 - app.logger - INFO - [WS] URL analysis completed for https://cursor.com/agents: safe=True, source=combined
2025-12-04 23:21:53,311 - app.logger - INFO - [WS] Sent analysis_result for https://cursor.com/agents to client 90b7b6fe-6579-47d4-bde0-46cdbd3d4908
2025-12-04 23:21:53,312 - app.logger - INFO - [WS] Starting URL analysis for: https://cursor.com/agents (context: link_check)
2025-12-04 23:21:53,312 - app.logger - INFO - üîç Analyzing URL: https://cursor.com/agents (ignore_db=False)
2025-12-04 23:21:53,312 - app.logger - INFO - [WS] URL analysis completed for https://cursor.com/agents: safe=True, source=combined
2025-12-04 23:21:53,312 - app.logger - INFO - [WS] Sent analysis_result for https://cursor.com/agents to client 90b7b6fe-6579-47d4-bde0-46cdbd3d4908
2025-12-04 23:21:54,894 - app.logger - INFO - [WS] Starting URL analysis for: https://cursor.com/dashboard (context: hover)
2025-12-04 23:21:54,894 - app.logger - INFO - üîç Analyzing URL: https://cursor.com/dashboard (ignore_db=False)
2025-12-04 23:21:54,898 - app.logger - WARNING - ‚ö†Ô∏è Private/internal URL detected, skipping external APIs: https://cursor.com/dashboard
2025-12-04 23:21:54,903 - app.logger - INFO - [WS] URL analysis completed for https://cursor.com/dashboard: safe=True, source=internal_only
2025-12-04 23:21:54,903 - app.logger - INFO - [WS] Sent analysis_result for https://cursor.com/dashboard to client 90b7b6fe-6579-47d4-bde0-46cdbd3d4908
2025-12-04 23:21:58,067 - app.logger - INFO - [WS] Starting URL analysis for: https://cursor.com/dashboard (context: link_check)
2025-12-04 23:21:58,067 - app.logger - INFO - üîç Analyzing URL: https://cursor.com/dashboard (ignore_db=False)
2025-12-04 23:21:58,067 - app.logger - WARNING - Ignoring cached safe=True result with source=internal_only for url:https://cursor.com/dashboard
2025-12-04 23:21:58,074 - app.logger - WARNING - ‚ö†Ô∏è Private/internal URL detected, skipping external APIs: https://cursor.com/dashboard
2025-12-04 23:21:58,077 - app.logger - INFO - [WS] URL analysis completed for https://cursor.com/dashboard: safe=True, source=internal_only
2025-12-04 23:21:58,078 - app.logger - INFO - [WS] Sent analysis_result for https://cursor.com/dashboard to client 90b7b6fe-6579-47d4-bde0-46cdbd3d4908
2025-12-04 23:29:35,323 - app.logger - INFO - [WS] Client disconnected gracefully: 90b7b6fe-6579-47d4-bde0-46cdbd3d4908
2025-12-04 23:29:35,324 - app.logger - INFO - [WS] Client disconnected: id=90b7b6fe-6579-47d4-bde0-46cdbd3d4908, reason=cleanup
2025-12-04 23:29:35,424 - app.logger - INFO - Background job manager stopped
2025-12-04 23:29:35,425 - app.logger - INFO - Background job manager stopped
2025-12-04 23:29:36,078 - app.logger - INFO - Logging system initialized with rotation
2025-12-04 23:29:36,081 - app.database - INFO - Initializing database at: /opt/Aegis/data/antivirus.db
2025-12-04 23:29:36,084 - app.database - INFO - Database initialized successfully with all tables
2025-12-04 23:29:36,202 - app.logger - INFO - [ENV] env.env loaded: yes (/opt/aegis/antivirus-core/app/env.env)
2025-12-04 23:29:36,202 - app.logger - INFO - [ENV] VIRUSTOTAL_API_KEY: 8958...96ce
2025-12-04 23:29:36,203 - app.logger - INFO - [External APIs] Enabled map: {'virustotal': True, 'google_safe_browsing': False, 'abuseipdb': True}
2025-12-04 23:29:36,282 - app.logger - INFO - üöÄ AEGIS Server starting up...
2025-12-04 23:29:36,284 - app.logger - INFO - ‚úÖ Database tables verified
2025-12-04 23:29:36,285 - app.logger - INFO - Database connection established successfully
2025-12-04 23:29:36,288 - app.database - INFO - Rate limits reset successfully
2025-12-04 23:29:36,289 - app.logger - INFO - Rate limits reset
2025-12-04 23:29:36,289 - app.logger - INFO - Background job manager started
2025-12-04 23:29:36,289 - app.logger - INFO - Background job manager started
2025-12-04 23:29:36,289 - app.logger - INFO - WebSocket cleanup task started
2025-12-04 23:29:36,289 - app.logger - INFO - ‚úÖ AEGIS Server startup complete
2025-12-04 23:29:36,934 - app.logger - INFO - [WS] WebSocket connection attempt from 91.238.88.83
2025-12-04 23:29:36,935 - app.logger - INFO - [WS] WebSocket connection accepted from 91.238.88.83
2025-12-04 23:29:36,943 - app.logger - INFO - [WS] Client connected: id=3e49efda-60da-46a7-b0ae-ccd38b9ec943, ip=91.238.88.83
